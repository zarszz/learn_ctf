<?php
require_once 'flag.php';
if (isset($_GET['a']) and isset($_GET['hash'])) {

    $res         = sanitize($_GET['a']);
    $hash        = sanitize($_GET['hash']);
    $secretValue = (rand(5, 5555) * 555 + 55555555555);

    if (($res != false) and ($hash != false)) {
        if ($res . $secretValue == md5($_GET['hash'])) {

            echo "Congrats you is the hero : $flag";
        } else {
            echo 'Try Again ... ';

        }
    } else {
        echo "No Acess !";
    }
} else {
    echo "<img src='http://sqlbak.com/blog/wp-content/uploads/2014/02/bak_file.png'>";
}

//function
function sanitize($var)
{
    $valideChar = str_split('azertyuiopmlkjhgfdsqwxcvbnAZERTYUIOPMLKJHGFDSQWXCVBN0987654321');
    $res        = '';

    if (isset($var) and !empty($var)) {
        $tmp = str_split($var);

        foreach ($tmp as $value) {
            if (in_array($value, $valideChar)) {
                $res .= $value;
            }
        }
        return $res;
    } else {
        return false;
    }
}
